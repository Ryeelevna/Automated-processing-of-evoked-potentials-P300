# Автоматизированная обработка вызванных потенциалов P300

Данный алгоритм был написан в рамках разработки малогабаритного электроэнцефалографа с минимальным количеством каналов при высокой точности результатов, специализирующегося на регистрации вызванных потенциалов P300 для диагностики деменции и оценки динамики состояния пациентов с данным синдромом.

Программа реализована в среде MATLAB в 2018 году.

Протестирована на здоровом испытуемом. Представленный далее пример работы программы основан на результатах проведённых тестов.

Алгоритм основывается на использовании метода вызванных потенциалов P300 - это вид ЭЭГ-исследований, который является перспективным для углублённого изучения механизмов нарушений когнитивных функций мозга и включён в рекомендуемые для клинического использования Американской и Международной ассоциациями клинических нейрофизиологов.

Вызванные потенциалы - это ответы мозга на эндогенные и экзогенные фиксированные события (стимулы). Они являются индикаторами электрических процессов в мозге, связанных с механизмом обработки и восприятия информации. Сущность метода P300 заключается в том, что выделяется реакция на некоторый стимул, связанная с приходом афферентации, и анализируются эндогенные события, связанные с распознаванием и запоминанием стимула. Метод основывается на подаче случайной последовательности частых незначимых и редких значимых стимулов, из которых пациент должен выделять и подсчитывать значимые. Последние отмечаются появлением большой позитивной волны в течение 300 мс.

![alt text](https://github.com/Ryeelevna/Automated-processing-of-evoked-potentials-P300/blob/main/pics/P300_01.PNG)

Параметры P300 зависят от возраста пациента и состояния его когнитивных функций (оперативная память, мышление и внимание): с ухудшением когнитивных функций имеется тенденция к уменьшению амплитуды волны и увеличению её латентности. Особенно наглядно это может быть проанализировано при деменции.

Основная сложность в анализе вызванных потенциалов заключается в том, что ответы мозга значительно ниже спонтанной активности ЭЭГ. Поэтому существует такой метод выделения ВП, как метод синхронного или когерентного накопления (усреднения). Его суть заключается в многократной подаче стимулов и последовательной суммации ответов. В результате этого закономерно связанный со стимулом сигнал ВП растёт значительно быстрее шума спонтанной ритмики, который не связан со стимулом и при суммации попадает в случайную фазу друг с другом.

![alt text](https://github.com/Ryeelevna/Automated-processing-of-evoked-potentials-P300/blob/main/pics/P300_02.PNG)

Усреднение проводится раздельно для значимых и незначимых стимулов. Для правильной интерпретации результатов ответы на значимые стимулы сравнивают с ответами на незначимые.

Пример исходного сигнала, канал Fz (один из тех, в которых P300 выражен лучше всего), где по оси Х – номера отсчётов, по Y – разность потенциалов в мкВ:

![alt text](https://github.com/Ryeelevna/Automated-processing-of-evoked-potentials-P300/blob/main/pics/P300_03.PNG)

Результат обработки сигнала методом когерентного усреднения:

![alt text](https://github.com/Ryeelevna/Automated-processing-of-evoked-potentials-P300/blob/main/pics/P300_04.PNG)

На данном графике представлен сигнал, усреднённый по каждому из стимулов по-отдельности, среди которых только один является значимым, а остальные 8 - незначимые. И кривая, построенная по значимому стимулу, явно выделяется среди остальных.

Но в сигнале, помимо шума спонтанной ритмики, также всегда присутствуют артефакты моргания, которые негативно влияют на качество обработки сигнала. Для их устранения используется вспомогательный канал Fpz - тот, в котором преобладают эти артефакты. Алгоритм производит их поиск в шумном сигнале, чтобы затем вычесть их из сигнала с P300. На представленном ниже примере найденные артефакты выделены оранжевыми вертикальными линиями.

![alt text](https://github.com/Ryeelevna/Automated-processing-of-evoked-potentials-P300/blob/main/pics/P300_05.PNG)

Результат усреднения после фильтрации сигнала от артефактов моргания:

![alt text](https://github.com/Ryeelevna/Automated-processing-of-evoked-potentials-P300/blob/main/pics/P300_06.PNG)

График, соответствующий значимым ответам, стал выделяться сильнее. Найденные потенциалы P300 отмечаются вертикальной линией. Их можно оценить как визуально на графике, так и по параметрам (амплитуда и латентность), которые выводятся программой в виде числовых значений.
